import matplotlib.pyplot as PLT
import numpy as NP
import pandas as PD


wls = NP.linspace(300,780,481)
fcab = [0.07522930244608403, 0.07695254623902305, 0.07855021995570398, 0.08073166452084143, 0.08237265925271818, 0.08386728029348599, 0.0856350290290632, 0.08744292941478245, 0.08876202725656396, 0.09051333301596239, 0.09279789972565144, 0.09370057517318166, 0.09541820875260133, 0.09730174148348925, 0.09909979376615187, 0.100780711039901, 0.10285085134977341, 0.10442489372205872, 0.10735891783235806, 0.10856438060284464, 0.11134823173637798, 0.11247549635665792, 0.11507718211698947, 0.11677686115532646, 0.11860620171711034, 0.12024662923136921, 0.12212829707091963, 0.1243082415399782, 0.12654361245755916, 0.12829470651750974, 0.13096339774499477, 0.13169675541783232, 0.13245058451481573, 0.13468916671054598, 0.13801052462543392, 0.14804561893326385, 0.14464094274983158, 0.15515274842275875, 0.15547957284164063, 0.15326157244829328, 0.15632781952805772, 0.15745238939472558, 0.17333746078936754, 0.16473382911221734, 0.15974337718523654, 0.1707194439508539, 0.1765581408114681, 0.17216409143844055, 0.18074173322059608, 0.1774996913072923, 0.18179139763621532, 0.1815571283890337, 0.18458451372629833, 0.20156759816544217, 0.18579028621277924, 0.19766383115549005, 0.19938330789340178, 0.19764006593571976, 0.2005457083541841, 0.2031428597898056, 0.21064798917997504, 0.21790916860649903, 0.21639110243967175, 0.22378457262686538, 0.22640709346787793, 0.22569245250391054, 0.22983242631907674, 0.23250616508370497, 0.23903181282653008, 0.23735224722583245, 0.24476591383748297, 0.24060846679000564, 0.26616472797866997, 0.2565503523388766, 0.2681366894788877, 0.26919257806277436, 0.2835071876297076, 0.28201606870289114, 0.28611277158402065, 0.29507294368219067, 0.2966478919935032, 0.2934349540468211, 0.31317100840336703, 0.3242069064977791, 0.33210979818021735, 0.34263918249881004, 0.3485491492125014, 0.3601002627568072, 0.374866816104318, 0.3863974800590695, 0.3810384918709333, 0.3984016329953354, 0.4107785620951755, 0.42437949201918335, 0.43671989740382877, 0.4527046726637053, 0.4625988192069547, 0.4869011809387908, 0.49137962673543134, 0.5097460316356256, 0.5327447008482116, 0.5475399628710703, 0.5626580641510909, 0.5755635717592431, 0.5860728199933818, 0.594614962381575, 0.6009421447535519, 0.60709969849941, 0.6132288752994287, 0.6194292353548034, 0.6266291927152773, 0.6340253773754451, 0.6400867328210031, 0.6447840680831056, 0.6486411058761273, 0.6523875166515272, 0.6558293349681236, 0.6590497787058252, 0.661906325143745, 0.6650236852313116, 0.6687038988594358, 0.673150037584257, 0.6771597119015685, 0.6809533092884615, 0.6838803415789266, 0.6871671660336109, 0.6911628556889045, 0.6956464409623426, 0.699279224347493, 0.703082734168179, 0.7072001137889309, 0.7113162859657098, 0.7150095811109267, 0.7183249145808303, 0.7212364540129378, 0.7238635308941577, 0.7259569212879022, 0.7274073847809182, 0.7285129452807827, 0.7287769211740542, 0.7283398135165827, 0.7268880442311743, 0.7246923059943194, 0.7222595895040884, 0.7193770226443311, 0.7159105301630538, 0.7122106359668781, 0.7084603259175215, 0.7038096082001709, 0.6989894147730398, 0.6939746051927907, 0.6888735970625167, 0.6833581764765605, 0.6781978559599087, 0.673490075659193, 0.6692742029646608, 0.6653310419600756, 0.6618061873050366, 0.658960414684528, 0.6570360998813585, 0.6556595629725485, 0.6548416454359349, 0.6549978378405334, 0.6552876873081184, 0.6557720430190498, 0.6557064799013589, 0.6561280550485571, 0.6566601423747984, 0.6575880000317492, 0.6581331097973502, 0.6584136802163598, 0.6589186204411849, 0.6589265681406729, 0.6585478505545422, 0.6578676939343505, 0.6570159557636404, 0.6560234620315627, 0.6542511416895685, 0.6524674046426929, 0.6507151297006161, 0.6491229014510281, 0.6470172332618258, 0.644712756780738, 0.6424977267476766, 0.6401318566476393, 0.6377076801318096, 0.6352021468917076, 0.6322316147462143, 0.6291564042511826, 0.6255887272275965, 0.6222447190484428, 0.6184169169007478, 0.6140174700345351, 0.6090524895622152, 0.6038350699792809, 0.598051309429889, 0.5918042900854307, 0.5849645579191987, 0.5776476173504107, 0.5699332014386113, 0.5616038069313721, 0.5528516221206959, 0.5438636828411411, 0.5342945996644425, 0.5243554610755822, 0.5140327923191842, 0.5032470634283343, 0.4924625804111454, 0.4817412268191736, 0.47041663850193305, 0.45871286922934174, 0.44635425361981923, 0.433673886179452, 0.4216767215954413, 0.40965280777467866, 0.3974997329720891, 0.3860638597568471, 0.3755628874013993, 0.3664253237566322, 0.3589274390125204, 0.35348438910554536, 0.3498110479301197, 0.3487526034730478, 0.35033891380569077, 0.35558887122940214, 0.36392616757604407, 0.376014966588507, 0.39121369949604773, 0.4099968010489139, 0.431055669781187, 0.45474064908884637, 0.4796029320908664, 0.5062422570953977, 0.5336926523106295, 0.5619960760699267, 0.5899443179730172, 0.6180977691310657, 0.6449270353826837, 0.6713076071469467, 0.6962133866831887, 0.7201829114262297, 0.7427240518048969, 0.763670282133408, 0.783825185534122, 0.8025691860575275, 0.820060672238587, 0.836163756520907, 0.851309869452743, 0.8652493416121803, 0.8781264443412279, 0.8898684030571503, 0.9004518552220746, 0.9097592116753038, 0.919078906838968, 0.9266592658276109, 0.9323133225389678, 0.9354823441886053, 0.937858110651534, 0.9395367860647018, 0.9403966848061173, 0.9412044274224828, 0.9420383103851652, 0.9429230729252992, 0.9438699454838201, 0.9448639688086364, 0.9459332841024675, 0.9470343415087822, 0.9481787793599815, 0.9493388448651663, 0.9505244144263678, 0.9516960040417761, 0.9528475384344096, 0.9539623339863491, 0.9550308853041958, 0.9560402845902684, 0.9569892371017219, 0.9578731605341974, 0.9587044583888541, 0.95947118307483, 0.960191039625818, 0.9608620264379465, 0.9615067393020057, 0.9621111902255028, 0.9626713471068787, 0.9631988901556332, 0.9636996940026966, 0.9641574699879845, 0.9645838553759071, 0.9649761205807637, 0.9653434313705104, 0.9656724693487675, 0.9659764742554583, 0.9662540301081579, 0.966508735113499, 0.9667394924443583, 0.9669508488878766, 0.9671511924209867, 0.9673542088523813, 0.9675483662568326, 0.9677443742354876, 0.9679500602726843, 0.968174762350045, 0.9684141670679809, 0.968666261732488, 0.9689449183612003, 0.9692454649278583, 0.9695696308452815, 0.9699200959388129, 0.9702880918409776, 0.9706751073026958, 0.9710650215977853, 0.9714539951190525, 0.9718490913244009, 0.9722523369042136, 0.972650582229975, 0.9730307113743492, 0.9733964200487495, 0.9737477678207694, 0.9740764182255034, 0.9743690039315993, 0.974628614231501, 0.9748647341960652, 0.9750675601597631, 0.9752433663714427, 0.9753954371237499, 0.9755205908680722, 0.9756259969387467, 0.9757066893805522, 0.9757763948321384, 0.9758389487727096, 0.9759083248446371, 0.9759875685414189, 0.9760889192347759, 0.976225391423966, 0.9763980389191482, 0.9766161912908405, 0.9768785945026538, 0.9771974469012156, 0.9775514098436003, 0.9779506486221511, 0.978373848978014, 0.9788241053062661, 0.9792886500217456, 0.9797634655924763, 0.9802343723188089, 0.9807015033378178, 0.9811481391293808, 0.9815658107061462, 0.9819551471987913, 0.982295024218571, 0.9826027204757192, 0.9828690799597954, 0.9831162267323997, 0.983353078520084, 0.9835956920752101, 0.9838593493260757, 0.9841455614244167, 0.984476003540933, 0.9848344881333069, 0.9852378442708835, 0.9856627026852585, 0.9861280455254964, 0.9865950608523224, 0.9870669529108913, 0.9875266480332796, 0.9879741022252311, 0.9883994248432977, 0.9887692408535417, 0.9891091861948981, 0.989396969687376, 0.9896572384544629, 0.989863310469711, 0.9900392672097792, 0.9901752488327575, 0.9902898181979944, 0.990361461759685, 0.9904157744245474, 0.9904099216433884, 0.9903790134625048, 0.9902511075594151, 0.99007388000188, 0.9897278348050924, 0.989310002341605, 0.9887042605849552, 0.9879928287640949, 0.9870689526660152, 0.9860164099094377, 0.9847783357232518, 0.9833681186499504, 0.9817335719935553, 0.9798885261928638, 0.977814048692876, 0.975486877982089, 0.9728736253729271, 0.969978347714926, 0.9668266040748378, 0.9633607710994831, 0.9596063173678008, 0.9555287242209817, 0.9511914516484309, 0.9465439162808831, 0.9416421743409156, 0.9364791803263421, 0.9310984937465857, 0.9254805747206309, 0.9196590537922258, 0.9136074657247795, 0.9073339955075571, 0.9008051383818024, 0.893985399771496, 0.8868545121156506, 0.8794198701954842, 0.8716149484356837, 0.863416205946116, 0.8547625604022648, 0.8456862308121189, 0.8360942043250104, 0.8259986239419119, 0.8153931507504397, 0.8041966373555977, 0.7924313319962518, 0.7800715598618286, 0.7670684428245846, 0.7534309805876499, 0.7391802109269406, 0.7243033398791419, 0.7087834977762134, 0.6927297322640413, 0.6760211511777507, 0.6587691390316542, 0.6410149937359944, 0.6228637310258139, 0.6041123979699489, 0.5849071561672384, 0.5655601734697037, 0.5461716858701855, 0.5265393073017652, 0.5070286822895455, 0.4875592987158449, 0.4681885067679392, 0.4493187107272018, 0.43107694097753546, 0.4131586034074866, 0.39603532112402356, 0.3794896145860868, 0.3638549122602785, 0.348994888147367, 0.33523861366530866, 0.3225297576359284, 0.31064840611634853, 0.3000457344268797, 0.28912621923663095, 0.27792925760147624, 0.2664534063029783, 0.25472711735861303, 0.2427631702939621, 0.23058064791105318, 0.21820057599103854, 0.20566104770432728, 0.1929846584938185, 0.18021754219910557, 0.167395586356049, 0.15456365301620784, 0.14177243500836442, 0.1290765575453901, 0.11653795208043631, 0.10422085787264901, 0.09219568087158544, 0.08053975473762418, 0.06932718722540224, 0.05864530435419851, 0.04857614613782005, 0.03921007658863695, 0.030637589808343614, 0.02294661925201288, 0.01622568257260924, 0.010560748701132406, 0.00603343906496498, 0.002719827774966831, 0.0006886960564306213, 1.512219827807759e-10]


fig = PLT.figure(1, figsize=(6,4), dpi=300)
ax = fig.add_subplot(111)
ax.plot(wls, fcab, "k-")
ax.set_xlim(300, 800)
ax.set_ylim(0, 1)
ax.set_ylabel("Fraction absorbed by CHL (-)", fontsize=12)
ax.set_xlabel("Wavelength (nm)", fontsize=12)
fig.set_tight_layout(True)
fig.savefig("../figure/s1_chl_fraction.pdf", bbox_inches="tight")


fitting = PD.read_csv("../output/6_fitting.csv")
fig = PLT.figure(2, dpi=300, figsize=(4,4))
ax = fig.add_subplot(111)
ax.plot(fitting.VCMAX_FIT * 1.67, fitting.VCMAX_FIT_CYTO * 7 / 300, "ko", mfc="none")
ax.set_xlabel("Farquhar Model Jmax25 (μmol m⁻² s⁻¹)", fontsize=12)
ax.set_ylabel("J&B Model b6f (μmol m⁻²)", fontsize=12)
fig.set_tight_layout(True)
fig.savefig("../figure/s6_jmax_b6f.pdf", bbox_inches="tight")
